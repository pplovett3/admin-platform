# YFè¯¾ç¨‹åº”ç”¨éƒ¨ç½²æŒ‡å—

## è‡ªåŠ¨å‘ç°æœºåˆ¶è¯´æ˜

å¯åŠ¨å™¨æ”¯æŒ**è‡ªåŠ¨æ£€æµ‹**å·²å®‰è£…çš„è¯¾ç¨‹ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®ï¼

### æ£€æµ‹ä¼˜å…ˆçº§

1. **Windowsæ³¨å†Œè¡¨**ï¼ˆæ¨èï¼‰
2. **æ ‡å‡†å®‰è£…è·¯å¾„æ‰«æ**
3. **æ‰‹åŠ¨é…ç½®æ–‡ä»¶** (`courses.json`)

---

## æ–¹æ¡ˆä¸€ï¼šæ³¨å†Œè¡¨æ–¹å¼ï¼ˆæ¨èï¼‰â­

### Unityåº”ç”¨åœ¨å®‰è£…æ—¶å†™æ³¨å†Œè¡¨

åœ¨Unityåº”ç”¨çš„å®‰è£…ç¨‹åºï¼ˆInno Setup / NSISï¼‰ä¸­æ·»åŠ æ³¨å†Œè¡¨é¡¹ï¼š

#### Inno Setupç¤ºä¾‹ï¼š

```ini
[Registry]
Root: HKLM; Subkey: "SOFTWARE\YFCourses\{#CourseId}"; ValueType: string; ValueName: "InstallPath"; ValueData: "{app}\{#AppExeName}"; Flags: uninsdeletekey
Root: HKLM; Subkey: "SOFTWARE\YFCourses\{#CourseId}"; ValueType: string; ValueName: "CourseName"; ValueData: "{#CourseName}"; Flags: uninsdeletekey
```

#### NSISç¤ºä¾‹ï¼š

```nsis
WriteRegStr HKLM "SOFTWARE\YFCourses\${COURSE_ID}" "InstallPath" "$INSTDIR\${APP_EXE}"
WriteRegStr HKLM "SOFTWARE\YFCourses\${COURSE_ID}" "CourseName" "${COURSE_NAME}"
```

#### æ‰‹åŠ¨æ³¨å†Œï¼ˆæµ‹è¯•ç”¨ï¼‰ï¼š

```reg
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\YFCourses\690af61251fc83dcf5a7d37d]
"InstallPath"="D:\\UnityProjects\\MyCourse\\Build\\MyCourse.exe"
"CourseName"="Unityå¯åŠ¨æµ‹è¯•è¯¾ç¨‹"
```

ä¿å­˜ä¸º `.reg` æ–‡ä»¶ï¼ŒåŒå‡»å¯¼å…¥ã€‚

### æ³¨å†Œè¡¨ç»“æ„

```
HKLM\SOFTWARE\YFCourses\{courseId}
  - InstallPath (REG_SZ): åº”ç”¨ç¨‹åºexeçš„å®Œæ•´è·¯å¾„
  - CourseName (REG_SZ): è¯¾ç¨‹åç§°
```

æˆ–

```
HKCU\SOFTWARE\YFCourses\{courseId}
  - InstallPath (REG_SZ): åº”ç”¨ç¨‹åºexeçš„å®Œæ•´è·¯å¾„
  - CourseName (REG_SZ): è¯¾ç¨‹åç§°
```

**æ³¨æ„**ï¼š`courseId` å¿…é¡»ä¸æ•°æ®åº“ä¸­çš„è¯¾ç¨‹IDå®Œå…¨ä¸€è‡´ï¼

---

## æ–¹æ¡ˆäºŒï¼šæ ‡å‡†è·¯å¾„ + course.json

### 1. å®‰è£…åˆ°æ ‡å‡†è·¯å¾„

å°†è¯¾ç¨‹åº”ç”¨å®‰è£…åˆ°ä»¥ä¸‹ä»»ä¸€è·¯å¾„ï¼š

- `C:\Program Files\YF Courses\`
- `C:\Program Files (x86)\YF Courses\`
- `D:\YF Courses\`
- `E:\YF Courses\`

### 2. ç›®å½•ç»“æ„

```
C:\Program Files\YF Courses\
â”œâ”€â”€ Unityå¯åŠ¨æµ‹è¯•è¯¾ç¨‹\
â”‚   â”œâ”€â”€ MyCourse.exe          â† Unity/UE5åº”ç”¨
â”‚   â”œâ”€â”€ MyCourse_Data\
â”‚   â””â”€â”€ course.json           â† é…ç½®æ–‡ä»¶ï¼ˆé‡è¦ï¼ï¼‰
â””â”€â”€ å¦ä¸€ä¸ªè¯¾ç¨‹\
    â”œâ”€â”€ AnotherCourse.exe
    â”œâ”€â”€ AnotherCourse_Data\
    â””â”€â”€ course.json
```

### 3. course.json æ ¼å¼

åœ¨æ¯ä¸ªè¯¾ç¨‹ç›®å½•ä¸‹åˆ›å»º `course.json`ï¼š

```json
{
  "courseId": "690af61251fc83dcf5a7d37d",
  "name": "Unityå¯åŠ¨æµ‹è¯•è¯¾ç¨‹",
  "executable": "MyCourse.exe",
  "version": "1.0.0"
}
```

**å­—æ®µè¯´æ˜ï¼š**
- `courseId`: **å¿…é¡»**ä¸æ•°æ®åº“ä¸­çš„è¯¾ç¨‹IDå®Œå…¨ä¸€è‡´
- `name`: è¯¾ç¨‹åç§°ï¼ˆæ˜¾ç¤ºç”¨ï¼‰
- `executable`: å¯æ‰§è¡Œæ–‡ä»¶åï¼ˆç›¸å¯¹äºè¯¾ç¨‹ç›®å½•ï¼‰
- `version`: ç‰ˆæœ¬å·ï¼ˆå¯é€‰ï¼‰

---

## æ–¹æ¡ˆä¸‰ï¼šæ‰‹åŠ¨é…ç½®ï¼ˆå…œåº•æ–¹æ¡ˆï¼‰

å¦‚æœä»¥ä¸Šä¸¤ç§æ–¹å¼éƒ½ä¸é€‚ç”¨ï¼Œå¯ä»¥æ‰‹åŠ¨ç¼–è¾‘ `courses.json`ï¼š

### æ–‡ä»¶ä½ç½®

```
E:\ä¸Šä¿¡æ ¡äº§çº¿åŠ¨ç”»\admin-platform\launcher\courses.json
```

### é…ç½®æ ¼å¼

```json
{
  "courses": [
    {
      "courseId": "690af61251fc83dcf5a7d37d",
      "appPath": "D:/Unity Projects/MyCourse/Build/MyCourse.exe",
      "name": "Unityå¯åŠ¨æµ‹è¯•è¯¾ç¨‹"
    }
  ]
}
```

---

## éƒ¨ç½²æµç¨‹ç¤ºä¾‹

### åœºæ™¯ï¼šåˆ°å­¦æ ¡éƒ¨ç½²

#### 1. å‡†å¤‡å·¥ä½œï¼ˆå¼€å‘é˜¶æ®µï¼‰

**ç®¡ç†åå°åˆ›å»ºè¯¾ç¨‹ï¼š**
```
http://localhost:3001
â†’ è¯¾ç¨‹ç®¡ç† 
â†’ æ–°å»ºè¯¾ç¨‹
â†’ è®°å½•è¯¾ç¨‹ID: 690af61251fc83dcf5a7d37d
```

**Unityåº”ç”¨æ‰“åŒ…ï¼š**
1. Build Unityé¡¹ç›®
2. åˆ›å»ºå®‰è£…ç¨‹åºï¼ˆInno Setupï¼‰
3. åœ¨å®‰è£…è„šæœ¬ä¸­æ·»åŠ æ³¨å†Œè¡¨å†™å…¥
4. æµ‹è¯•å®‰è£…ç¨‹åº

#### 2. åˆ°å­¦æ ¡éƒ¨ç½²

**åœ¨å­¦æ ¡çš„ç”µè„‘ä¸Šï¼š**

1. **å®‰è£…Unity/UE5è¯¾ç¨‹åº”ç”¨**
   - è¿è¡Œå®‰è£…ç¨‹åº
   - åº”ç”¨è‡ªåŠ¨å†™å…¥æ³¨å†Œè¡¨æˆ–å®‰è£…åˆ°æ ‡å‡†è·¯å¾„

2. **å®‰è£…å¯åŠ¨å™¨**
   - æ‹·è´å¯åŠ¨å™¨å®‰è£…åŒ…
   - è¿è¡Œå®‰è£…

3. **å¯åŠ¨å¹¶æµ‹è¯•**
   - æ‰“å¼€å¯åŠ¨å™¨
   - å¯åŠ¨å™¨è‡ªåŠ¨æ£€æµ‹åˆ°å·²å®‰è£…çš„è¯¾ç¨‹
   - å­¦ç”Ÿç™»å½• â†’ æ¿€æ´» â†’ å¯åŠ¨

**æ— éœ€ä»»ä½•æ‰‹åŠ¨é…ç½®ï¼** âœ…

---

## éªŒè¯å®‰è£…

### æ£€æŸ¥æ³¨å†Œè¡¨

æ‰“å¼€æ³¨å†Œè¡¨ç¼–è¾‘å™¨ï¼ˆ`regedit`ï¼‰ï¼ŒæŸ¥çœ‹ï¼š

```
HKEY_LOCAL_MACHINE\SOFTWARE\YFCourses\
```

åº”è¯¥çœ‹åˆ°å·²å®‰è£…è¯¾ç¨‹çš„é¡¹ã€‚

### æ£€æŸ¥æ ‡å‡†è·¯å¾„

æ‰“å¼€æ–‡ä»¶ç®¡ç†å™¨ï¼Œæ£€æŸ¥ï¼š

```
C:\Program Files\YF Courses\
```

æ¯ä¸ªè¯¾ç¨‹ç›®å½•ä¸‹åº”è¯¥æœ‰ `course.json`ã€‚

### å¯åŠ¨å™¨æ—¥å¿—

å¯åŠ¨å™¨ä¼šåœ¨å¼€å‘è€…å·¥å…·çš„Consoleä¸­æ˜¾ç¤ºæ£€æµ‹æ—¥å¿—ï¼š

```
ğŸ” å¼€å§‹è‡ªåŠ¨æ£€æµ‹å·²å®‰è£…è¯¾ç¨‹...
ğŸ“‹ æ£€æŸ¥æ³¨å†Œè¡¨...
  âœ“ æ³¨å†Œè¡¨å‘ç° 2 é—¨è¯¾ç¨‹
ğŸ“‚ æ‰«ææ ‡å‡†å®‰è£…è·¯å¾„...
  âœ“ æ ‡å‡†è·¯å¾„å‘ç° 0 é—¨è¯¾ç¨‹
ğŸ“ è¯»å–æ‰‹åŠ¨é…ç½®...
  âœ“ æ‰‹åŠ¨é…ç½® 2 é—¨è¯¾ç¨‹
âœ… æ€»å…±å‘ç° 2 é—¨å¯ç”¨è¯¾ç¨‹
```

---

## Unityåº”ç”¨æ¥æ”¶Token

### C# ä»£ç ç¤ºä¾‹

```csharp
using UnityEngine;

public class AppStarter : MonoBehaviour
{
    void Start()
    {
        // è·å–å‘½ä»¤è¡Œå‚æ•°
        string[] args = System.Environment.GetCommandLineArgs();
        
        string token = null;
        
        // æŸ¥æ‰¾ --token å‚æ•°
        for (int i = 0; i < args.Length; i++)
        {
            if (args[i].StartsWith("--token="))
            {
                token = args[i].Substring(8);
                break;
            }
        }
        
        if (string.IsNullOrEmpty(token))
        {
            Debug.LogError("æœªæ‰¾åˆ°Tokenï¼Œåº”ç”¨åº”è¯¥ç”±å¯åŠ¨å™¨å¯åŠ¨ï¼");
            return;
        }
        
        Debug.Log("æ¥æ”¶åˆ°Token: " + token);
        
        // è§£æJWTè·å–ç”¨æˆ·ä¿¡æ¯
        var userInfo = ParseJWT(token);
        Debug.Log("ç”¨æˆ·ID: " + userInfo.userId);
        Debug.Log("ç”¨æˆ·å: " + userInfo.name);
    }
    
    UserInfo ParseJWT(string token)
    {
        // å®ç°JWTè§£æé€»è¾‘
        // æˆ–ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“å¦‚ jose-jwt
    }
}
```

---

## UE5åº”ç”¨æ¥æ”¶Token

### C++ ä»£ç ç¤ºä¾‹

```cpp
#include "CoreMinimal.h"
#include "Misc/CommandLine.h"

void AMyGameMode::BeginPlay()
{
    Super::BeginPlay();
    
    FString Token;
    
    // è·å–å‘½ä»¤è¡Œå‚æ•° -token=xxx
    if (FParse::Value(FCommandLine::Get(), TEXT("-token="), Token))
    {
        UE_LOG(LogTemp, Log, TEXT("æ¥æ”¶åˆ°Token: %s"), *Token);
        
        // è§£æJWTè·å–ç”¨æˆ·ä¿¡æ¯
        // ...
    }
    else
    {
        UE_LOG(LogTemp, Error, TEXT("æœªæ‰¾åˆ°Tokenå‚æ•°ï¼"));
    }
}
```

---

## å¸¸è§é—®é¢˜

### Q1: è¯¾ç¨‹IDåœ¨å“ªé‡Œè·å–ï¼Ÿ
**A:** åœ¨ç®¡ç†åå°çš„"è¯¾ç¨‹ç®¡ç†"é¡µé¢ï¼Œæ¯ä¸ªè¯¾ç¨‹éƒ½æœ‰å”¯ä¸€çš„IDï¼ˆ24ä½16è¿›åˆ¶å­—ç¬¦ä¸²ï¼‰ã€‚

### Q2: å®‰è£…ç¨‹åºå¦‚ä½•å†™æ³¨å†Œè¡¨ï¼Ÿ
**A:** ä½¿ç”¨Inno Setupæˆ–NSISç­‰å®‰è£…å·¥å…·ï¼Œåœ¨å®‰è£…è„šæœ¬ä¸­æ·»åŠ æ³¨å†Œè¡¨å†™å…¥å‘½ä»¤ã€‚

### Q3: å¯ä»¥æ··ç”¨å¤šç§æ–¹å¼å—ï¼Ÿ
**A:** å¯ä»¥ï¼å¯åŠ¨å™¨ä¼šè‡ªåŠ¨åˆå¹¶æ‰€æœ‰æ¥æºçš„é…ç½®ï¼Œä¼˜å…ˆä½¿ç”¨æ³¨å†Œè¡¨çš„é…ç½®ã€‚

### Q4: æ›´æ–°è¯¾ç¨‹åº”ç”¨åéœ€è¦é‡æ–°é…ç½®å—ï¼Ÿ
**A:** ä¸éœ€è¦ï¼åªè¦courseIdä¸å˜ä¸”å®‰è£…è·¯å¾„ä¸å˜ï¼Œå¯åŠ¨å™¨ä¼šè‡ªåŠ¨è¯†åˆ«ã€‚

### Q5: å¦‚ä½•è°ƒè¯•æ£€æµ‹è¿‡ç¨‹ï¼Ÿ
**A:** æ‰“å¼€å¯åŠ¨å™¨çš„å¼€å‘è€…å·¥å…·ï¼ˆCtrl+Shift+Iï¼‰ï¼ŒæŸ¥çœ‹Consoleæ—¥å¿—ã€‚

---

## æ¨èæ–¹æ¡ˆ

| åœºæ™¯ | æ¨èæ–¹æ¡ˆ | åŸå›  |
|------|---------|------|
| æ­£å¼éƒ¨ç½² | æ³¨å†Œè¡¨ | æœ€ä¸“ä¸šï¼Œè‡ªåŠ¨åŒ–ç¨‹åº¦é«˜ |
| å¼€å‘æµ‹è¯• | æ ‡å‡†è·¯å¾„ + course.json | ç®€å•å¿«é€Ÿï¼Œæ— éœ€å®‰è£…ç¨‹åº |
| åº”æ€¥æƒ…å†µ | æ‰‹åŠ¨é…ç½® | å…œåº•æ–¹æ¡ˆï¼Œæ€»èƒ½ç”¨ |

---

## ä¸‹ä¸€æ­¥

1. ä¸ºUnity/UE5åº”ç”¨åˆ›å»ºå®‰è£…ç¨‹åº
2. åœ¨å®‰è£…è„šæœ¬ä¸­æ·»åŠ æ³¨å†Œè¡¨å†™å…¥
3. æ‰“åŒ…å¹¶æµ‹è¯•
4. éƒ¨ç½²åˆ°å­¦æ ¡ç”µè„‘
5. âœ¨ äº«å—å…¨è‡ªåŠ¨ä½“éªŒï¼

