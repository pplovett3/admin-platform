# å¯åŠ¨å™¨è®¿é—®æ§åˆ¶ä½¿ç”¨æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

`LauncherAccessControl.cs` æä¾›3ç§å¼ºåº¦çš„è®¿é—®æ§åˆ¶ç­–ç•¥ï¼Œé˜²æ­¢ç”¨æˆ·ç›´æ¥æ‰“å¼€exeç»•è¿‡å¯åŠ¨å™¨ã€‚

---

## ğŸ”’ 3ç§æ§åˆ¶æ¨¡å¼

### æ¨¡å¼1ï¼šWarningï¼ˆè­¦å‘Šæ¨¡å¼ï¼‰âš ï¸

**è¡Œä¸ºï¼š**
- âœ… åº”ç”¨æ­£å¸¸æ‰“å¼€
- âš ï¸ æ˜¾ç¤ºè­¦å‘Šæç¤º
- âœ… æ‰€æœ‰åŠŸèƒ½å¯ç”¨
- âš ï¸ ä¸å¼ºåˆ¶ç”¨æˆ·å…³é—­

**é€‚ç”¨åœºæ™¯ï¼š**
- å¼€å‘æµ‹è¯•é˜¶æ®µ
- æ¼”ç¤ºç¯å¢ƒ
- éœ€è¦ç¦»çº¿ä½¿ç”¨çš„æƒ…å†µ

**ç”¨æˆ·ä½“éªŒï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš ï¸ æœªæˆæƒè®¿é—®è­¦å‘Š               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ£€æµ‹åˆ°æ‚¨ç›´æ¥æ‰“å¼€äº†æœ¬åº”ç”¨ã€‚      â”‚
â”‚                                 â”‚
â”‚  æœ¬åº”ç”¨åº”é€šè¿‡YFè¯¾ç¨‹å¯åŠ¨å™¨å¯åŠ¨ã€‚ â”‚
â”‚  ç›´æ¥æ‰“å¼€å¯èƒ½å¯¼è‡´éƒ¨åˆ†åŠŸèƒ½æ— æ³•   â”‚
â”‚  ä½¿ç”¨ã€‚                         â”‚
â”‚                                 â”‚
â”‚  è¯·å…³é—­æœ¬çª—å£å¹¶é€šè¿‡å¯åŠ¨å™¨å¯åŠ¨ã€‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### æ¨¡å¼2ï¼šLimitedï¼ˆé™åˆ¶æ¨¡å¼ï¼‰ğŸ”’

**è¡Œä¸ºï¼š**
- âœ… åº”ç”¨æ­£å¸¸æ‰“å¼€
- âš ï¸ æ˜¾ç¤ºåŠŸèƒ½å—é™æç¤º
- âŒ æ ¸å¿ƒåŠŸèƒ½è¢«ç¦ç”¨
- âœ… å¯ä»¥æµè§ˆåŸºç¡€å†…å®¹

**é€‚ç”¨åœºæ™¯ï¼š**
- æ­£å¼éƒ¨ç½²ï¼ˆæ¨èï¼‰
- éœ€è¦æ¼”ç¤ºåŸºç¡€åŠŸèƒ½
- æ—¢ä¿æŠ¤åˆä¸å®Œå…¨ç¦æ­¢è®¿é—®

**è¢«ç¦ç”¨çš„åŠŸèƒ½ï¼š**
- âŒ ä¿å­˜å­¦ä¹ è¿›åº¦
- âŒ æäº¤ä½œä¸š/æˆç»©
- âŒ è®¿é—®ä¸ªæ€§åŒ–å†…å®¹
- âŒ æ•°æ®åŒæ­¥

**å¯ç”¨çš„åŠŸèƒ½ï¼š**
- âœ… æµè§ˆè¯¾ç¨‹å†…å®¹
- âœ… è§‚çœ‹æ¼”ç¤º
- âœ… æŸ¥çœ‹è¯´æ˜

**ç”¨æˆ·ä½“éªŒï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”’ åŠŸèƒ½å—é™æ¨¡å¼                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åº”ç”¨å·²è¿›å…¥åŠŸèƒ½å—é™æ¨¡å¼ã€‚        â”‚
â”‚                                 â”‚
â”‚  æ‚¨å¯ä»¥æµè§ˆåŸºç¡€å†…å®¹ï¼Œä½†æ— æ³•ï¼š    â”‚
â”‚  â€¢ ä¿å­˜å­¦ä¹ è¿›åº¦                 â”‚
â”‚  â€¢ æäº¤ä½œä¸šæˆ–æˆç»©               â”‚
â”‚  â€¢ è®¿é—®ä¸ªæ€§åŒ–å†…å®¹               â”‚
â”‚                                 â”‚
â”‚  è¯·é€šè¿‡å¯åŠ¨å™¨å¯åŠ¨ä»¥è§£é”å…¨éƒ¨åŠŸèƒ½ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### æ¨¡å¼3ï¼šForceExitï¼ˆå¼ºåˆ¶é€€å‡ºï¼‰ğŸš«

**è¡Œä¸ºï¼š**
- â±ï¸ åº”ç”¨çŸ­æš‚æ‰“å¼€
- ğŸš« æ˜¾ç¤ºå€’è®¡æ—¶è­¦å‘Š
- âŒ 5ç§’åè‡ªåŠ¨é€€å‡º
- ğŸš« æ— æ³•ä½¿ç”¨ä»»ä½•åŠŸèƒ½

**é€‚ç”¨åœºæ™¯ï¼š**
- ä¸¥æ ¼æƒé™æ§åˆ¶
- è€ƒè¯•ç¯å¢ƒ
- å¿…é¡»å®ååˆ¶çš„åº”ç”¨

**ç”¨æˆ·ä½“éªŒï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸš« æœªæˆæƒè®¿é—®                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æœ¬åº”ç”¨å¿…é¡»é€šè¿‡YFè¯¾ç¨‹å¯åŠ¨å™¨å¯åŠ¨ï¼â”‚
â”‚                                 â”‚
â”‚  åº”ç”¨å°†åœ¨ 3 ç§’åè‡ªåŠ¨å…³é—­ã€‚       â”‚
â”‚                                 â”‚
â”‚  è¯·æ‰“å¼€YFè¯¾ç¨‹å¯åŠ¨å™¨ï¼š           â”‚
â”‚  1. ç™»å½•å­¦ç”Ÿè´¦å·                â”‚
â”‚  2. æ¿€æ´»è¯¾ç¨‹                    â”‚
â”‚  3. ç‚¹å‡»"å¯åŠ¨è¯¾ç¨‹"æŒ‰é’®          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. æ·»åŠ è„šæœ¬

åœ¨Unityåœºæ™¯ä¸­ï¼š

```
1. æ‰¾åˆ°æˆ–åˆ›å»º GameManager å¯¹è±¡
2. æ·»åŠ  LauncherAccessControl.cs ç»„ä»¶
3. åœ¨Inspectorä¸­é€‰æ‹©æ§åˆ¶æ¨¡å¼
```

### 2. é…ç½®å‚æ•°

```
Control Mode: 
  - Warning      (è­¦å‘Šæ¨¡å¼)
  - Limited      (é™åˆ¶æ¨¡å¼ï¼Œæ¨è)
  - ForceExit    (å¼ºåˆ¶é€€å‡º)

Token Timeout: 3ç§’
  ç­‰å¾…Tokençš„è¶…æ—¶æ—¶é—´

Exit Countdown: 5ç§’
  å¼ºåˆ¶é€€å‡ºæ¨¡å¼çš„å€’è®¡æ—¶
```

### 3. å¯é€‰ï¼šåˆ›å»ºè­¦å‘ŠUI

```csharp
// åˆ›å»ºä¸€ä¸ªPanelå’ŒTextç”¨äºæ˜¾ç¤ºè­¦å‘Š
GameObject warningPanel;  // æ‹–æ‹½åˆ°Inspector
Text warningText;         // æ‹–æ‹½åˆ°Inspector
```

---

## ğŸ’» ä»£ç é›†æˆç¤ºä¾‹

### åœ¨æ¸¸æˆé€»è¾‘ä¸­æ£€æŸ¥æˆæƒ

```csharp
using UnityEngine;

public class MyGameLogic : MonoBehaviour
{
    public void SaveProgress()
    {
        // æ£€æŸ¥æ˜¯å¦æˆæƒè®¿é—®
        if (!LauncherAccessControl.IsAuthorizedAccess())
        {
            Debug.LogWarning("æœªæˆæƒï¼šæ— æ³•ä¿å­˜è¿›åº¦");
            ShowMessage("è¯·é€šè¿‡å¯åŠ¨å™¨å¯åŠ¨ä»¥ä¿å­˜è¿›åº¦");
            return;
        }
        
        // ä¿å­˜è¿›åº¦é€»è¾‘
        PlayerPrefs.SetInt("Level", currentLevel);
        Debug.Log("è¿›åº¦å·²ä¿å­˜");
    }
}
```

### ä½¿ç”¨GameManageræ£€æŸ¥å—é™æ¨¡å¼

```csharp
using UnityEngine;

public class ScoreSubmission : MonoBehaviour
{
    public void SubmitScore(int score)
    {
        // æ£€æŸ¥æ˜¯å¦ä¸ºå—é™æ¨¡å¼
        if (GameManager.Instance.IsLimitedMode())
        {
            ShowWarning("åŠŸèƒ½å—é™ï¼šè¯·é€šè¿‡å¯åŠ¨å™¨å¯åŠ¨ä»¥æäº¤æˆç»©");
            return;
        }
        
        // æäº¤æˆç»©é€»è¾‘
        SendScoreToServer(score);
    }
}
```

### æ ¹æ®æˆæƒçŠ¶æ€æ˜¾ç¤ºä¸åŒUI

```csharp
using UnityEngine;
using UnityEngine.UI;

public class MainMenu : MonoBehaviour
{
    public Button saveButton;
    public Button submitButton;
    public Text statusText;
    
    void Start()
    {
        UpdateUIBasedOnAuth();
    }
    
    void UpdateUIBasedOnAuth()
    {
        bool isAuthorized = LauncherAccessControl.IsAuthorizedAccess();
        bool isLimited = GameManager.Instance?.IsLimitedMode() ?? false;
        
        if (isAuthorized && !isLimited)
        {
            // å®Œæ•´æ¨¡å¼
            statusText.text = "âœ… å®Œæ•´æ¨¡å¼";
            statusText.color = Color.green;
            saveButton.interactable = true;
            submitButton.interactable = true;
        }
        else if (isLimited)
        {
            // å—é™æ¨¡å¼
            statusText.text = "ğŸ”’ å—é™æ¨¡å¼";
            statusText.color = Color.yellow;
            saveButton.interactable = false;
            submitButton.interactable = false;
        }
        else
        {
            // æœªæˆæƒ
            statusText.text = "âš ï¸ æœªæˆæƒ";
            statusText.color = Color.red;
            saveButton.interactable = false;
            submitButton.interactable = false;
        }
    }
}
```

---

## ğŸ¯ æ¨èé…ç½®

### å¼€å‘æµ‹è¯•é˜¶æ®µ

```
æ¨¡å¼: Warning
åŸå› : æ–¹ä¾¿å¼€å‘è°ƒè¯•ï¼Œä¸å½±å“å·¥ä½œæµç¨‹
```

### æ¼”ç¤ºç¯å¢ƒ

```
æ¨¡å¼: Limited
åŸå› : å…è®¸å±•ç¤ºåŸºç¡€åŠŸèƒ½ï¼Œä½†ä¿æŠ¤æ ¸å¿ƒæ“ä½œ
```

### æ­£å¼éƒ¨ç½²

```
æ¨¡å¼: Limited æˆ– ForceExit
åŸå› : 
- Limited: ç”¨æˆ·ä½“éªŒå¥½ï¼Œæ—¢ä¿æŠ¤åˆä¸å¼ºç¡¬
- ForceExit: æœ€ä¸¥æ ¼ï¼Œé€‚ç”¨äºè€ƒè¯•ç­‰åœºæ™¯
```

---

## ğŸ”„ å®Œæ•´å·¥ä½œæµç¨‹

### åœºæ™¯1ï¼šé€šè¿‡å¯åŠ¨å™¨å¯åŠ¨ï¼ˆæ­£å¸¸ï¼‰

```
1. å¯åŠ¨å™¨å¯åŠ¨åº”ç”¨ï¼Œä¼ é€’Token
2. LauncherAccessControlæ£€æµ‹åˆ°Token
3. âœ… éªŒè¯é€šè¿‡
4. âœ… åº”ç”¨å®Œæ•´åŠŸèƒ½å¯ç”¨
```

### åœºæ™¯2ï¼šç›´æ¥åŒå‡»exeï¼ˆWarningæ¨¡å¼ï¼‰

```
1. ç”¨æˆ·åŒå‡»exe
2. LauncherAccessControlæœªæ£€æµ‹åˆ°Token
3. âš ï¸ æ˜¾ç¤ºè­¦å‘Š
4. âœ… åº”ç”¨ç»§ç»­è¿è¡Œï¼ˆåŠŸèƒ½å¯ç”¨ï¼‰
```

### åœºæ™¯3ï¼šç›´æ¥åŒå‡»exeï¼ˆLimitedæ¨¡å¼ï¼‰

```
1. ç”¨æˆ·åŒå‡»exe
2. LauncherAccessControlæœªæ£€æµ‹åˆ°Token
3. ğŸ”’ è¿›å…¥å—é™æ¨¡å¼
4. âš ï¸ æ ¸å¿ƒåŠŸèƒ½è¢«ç¦ç”¨
5. âœ… å¯æµè§ˆåŸºç¡€å†…å®¹
```

### åœºæ™¯4ï¼šç›´æ¥åŒå‡»exeï¼ˆForceExitæ¨¡å¼ï¼‰

```
1. ç”¨æˆ·åŒå‡»exe
2. LauncherAccessControlæœªæ£€æµ‹åˆ°Token
3. ğŸš« æ˜¾ç¤ºå€’è®¡æ—¶è­¦å‘Š
4. â±ï¸ 5ç§’åè‡ªåŠ¨é€€å‡º
5. âŒ åº”ç”¨å…³é—­
```

---

## ğŸ“Š å¯¹æ¯”è¡¨

| åŠŸèƒ½ | Warning | Limited | ForceExit |
|------|---------|---------|-----------|
| åº”ç”¨æ‰“å¼€ | âœ… | âœ… | â±ï¸ 5ç§’åé€€å‡º |
| æ˜¾ç¤ºè­¦å‘Š | âœ… | âœ… | âœ… |
| æµè§ˆå†…å®¹ | âœ… | âœ… | âŒ |
| ä¿å­˜è¿›åº¦ | âœ… | âŒ | âŒ |
| æäº¤æˆç»© | âœ… | âŒ | âŒ |
| ç”¨æˆ·ä½“éªŒ | å‹å¥½ | å¹³è¡¡ | ä¸¥æ ¼ |
| å®‰å…¨æ€§ | ä½ | ä¸­ | é«˜ |
| é€‚ç”¨åœºæ™¯ | æµ‹è¯• | æ­£å¼éƒ¨ç½² | è€ƒè¯•ç¯å¢ƒ |

---

## âš™ï¸ é«˜çº§é…ç½®

### è‡ªå®šä¹‰å—é™åŠŸèƒ½åˆ—è¡¨

```csharp
public class CustomAccessControl : LauncherAccessControl
{
    public bool CanAccessMultiplayer()
    {
        return IsAuthorizedAccess();
    }
    
    public bool CanUsePremiumContent()
    {
        return IsAuthorizedAccess();
    }
    
    public bool CanExportData()
    {
        return IsAuthorizedAccess();
    }
}
```

### ç½‘ç»œéªŒè¯ï¼ˆé¢å¤–å®‰å…¨ï¼‰

```csharp
IEnumerator VerifyTokenWithServer()
{
    if (!TokenReceiver.Instance.tokenReceived)
        yield break;
        
    string token = TokenReceiver.Instance.jwtToken;
    
    // å‘é€åˆ°æœåŠ¡å™¨éªŒè¯
    UnityWebRequest request = UnityWebRequest.Get(
        $"http://localhost:4000/api/activation/verify?token={token}"
    );
    
    yield return request.SendWebRequest();
    
    if (request.result == UnityWebRequest.Result.Success)
    {
        Debug.Log("âœ… æœåŠ¡å™¨éªŒè¯é€šè¿‡");
    }
    else
    {
        Debug.LogError("âŒ æœåŠ¡å™¨éªŒè¯å¤±è´¥");
        HandleForceExitMode();
    }
}
```

---

## ğŸ› è°ƒè¯•æŠ€å·§

### æµ‹è¯•ä¸åŒæ¨¡å¼

```csharp
#if UNITY_EDITOR
// åœ¨Editorä¸­æ¨¡æ‹Ÿæœªæˆæƒè®¿é—®
[MenuItem("Debug/æ¨¡æ‹Ÿæœªæˆæƒè®¿é—®")]
static void SimulateUnauthorizedAccess()
{
    if (TokenReceiver.Instance != null)
    {
        // æ¸…é™¤Token
        TokenReceiver.Instance.tokenReceived = false;
    }
}
#endif
```

### æŸ¥çœ‹å½“å‰çŠ¶æ€

```csharp
void OnGUI()
{
    GUILayout.Label($"æˆæƒçŠ¶æ€: {LauncherAccessControl.IsAuthorizedAccess()}");
    GUILayout.Label($"å—é™æ¨¡å¼: {GameManager.Instance?.IsLimitedMode()}");
}
```

---

## å¸¸è§é—®é¢˜

### Q1: Editorä¸­ä¼šè¢«æ‹¦æˆªå—ï¼Ÿ
**A:** ä¸ä¼šã€‚Editoræ¨¡å¼è‡ªåŠ¨è·³è¿‡æ£€æŸ¥ã€‚

### Q2: å¦‚ä½•ä¸´æ—¶ç¦ç”¨æ£€æŸ¥ï¼Ÿ
**A:** åœ¨Inspectorä¸­ç¦ç”¨ `LauncherAccessControl` ç»„ä»¶ã€‚

### Q3: ç”¨æˆ·å¯ä»¥ç»•è¿‡å—ï¼Ÿ
**A:** 
- Warning/Limited: æŠ€æœ¯é«˜æ‰‹å¯ä»¥ä¿®æ”¹å†…å­˜ç»•è¿‡
- ForceExit: è¾ƒéš¾ç»•è¿‡ï¼Œä½†å¯ä»¥é€šè¿‡ä¿®æ”¹dll
- å»ºè®®ï¼šé…åˆæœåŠ¡å™¨ç«¯éªŒè¯å®ç°çœŸæ­£çš„å®‰å…¨

### Q4: å½±å“æ€§èƒ½å—ï¼Ÿ
**A:** å‡ ä¹æ²¡æœ‰å½±å“ã€‚åªåœ¨å¯åŠ¨æ—¶æ£€æŸ¥ä¸€æ¬¡ã€‚

---

## ğŸ“ æœ€ä½³å®è·µ

1. âœ… **æ¨èä½¿ç”¨ Limited æ¨¡å¼**
   - å¹³è¡¡ç”¨æˆ·ä½“éªŒå’Œå®‰å…¨æ€§
   
2. âœ… **æä¾›æ¸…æ™°çš„æç¤ºä¿¡æ¯**
   - å‘Šè¯‰ç”¨æˆ·å¦‚ä½•æ­£ç¡®å¯åŠ¨
   
3. âœ… **ä¿ç•™åŸºç¡€åŠŸèƒ½**
   - è®©ç”¨æˆ·èƒ½ä½“éªŒåˆ°åº”ç”¨ä»·å€¼
   
4. âœ… **é…åˆæœåŠ¡å™¨éªŒè¯**
   - å…³é”®æ“ä½œåœ¨æœåŠ¡å™¨ç«¯å†æ¬¡éªŒè¯
   
5. âœ… **è®°å½•æœªæˆæƒè®¿é—®**
   - ç”¨äºåˆ†æå’Œæ”¹è¿›

---

## ä¸‹ä¸€æ­¥

1. âœ… é€‰æ‹©åˆé€‚çš„æ§åˆ¶æ¨¡å¼
2. âœ… æ·»åŠ è„šæœ¬åˆ°åœºæ™¯
3. âœ… æµ‹è¯•å„ç§åœºæ™¯
4. âœ… é…ç½®è­¦å‘ŠUI
5. âœ… Buildå¹¶æµ‹è¯•

æ–‡æ¡£å®Œæˆï¼æ ¹æ®ä½ çš„éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ¨¡å¼ï¼ğŸš€

